@let vehicleData = this.vehicle();

<div class="vehicle-details-container">
  @if (vehicleData) {
    <div class="vehicle-card">
      <!-- Secci√≥n de im√°genes -->
      <div class="image-section">
        <div class="image-gallery">
          @if (selectedImage()) {
            <img [src]="selectedImage()" [alt]="vehicleData.model" class="main-image">
          } @else {
            <div class="no-image">Sin imagen disponible</div>
          }

          @if (vehicleData.images && vehicleData.images.length > 1) {
            <div class="thumbnail-gallery">
              @for (image of vehicleData.images; track $index) {
                <img 
                  [src]="image" 
                  [alt]="vehicleData.model + ' miniatura ' + ($index + 1)"
                  class="thumbnail"
                  (click)="selectImage(image)"
                  [class.active]="image === selectedImage()"
                >
              }
            </div>
          }
        </div>
      </div>

      <!-- Secci√≥n de informaci√≥n -->
      <div class="info-section">
        <div class="vehicle-info-card">
          <div class="vehicle-header">
            <h1 class="vehicle-title">{{vehicleData.brand}} {{vehicleData.model}}</h1>
            <div class="price-tag">
              ${{vehicleData.price | number:'1.0-0'}}
            </div>
          </div>

          <div class="vehicle-details-grid">
            <div class="detail-item">
              <span class="detail-label">üìÖ A√±o:</span>
              <span class="detail-value">{{vehicleData.year}}</span>
            </div>
            
            <div class="detail-item">
              <span class="detail-label">üé® Color:</span>
              <span class="detail-value">{{vehicleData.color}}</span>
            </div>
          </div>

          @if (vehicleData.description) {
            <div class="description-section">
              <h3 class="description-title">Descripci√≥n</h3>
              <p class="description-text">{{vehicleData.description}}</p>
            </div>
          }

          <div class="actions-section">
            @if (!isAdmin()) {
              <button class="action-btn primary" (click)="openInquiryForm()">
                üí¨ Consultar
              </button>
              <button
                class="action-btn secondary"
                (click)="openBookingForm()"
                [class.disabled]="!isLoggedIn()"
                [title]="!isLoggedIn() ? 'Debes iniciar sesi√≥n para reservar' : 'Reservar este veh√≠culo'">
                üìÖ Reservar
              </button>
            }
            @if (isAdmin()) {
              <button class="action-btn danger" (click)="deleteVehicle()">
                üóëÔ∏è Eliminar
              </button>
              <button class="action-btn warning" (click)="toggleEdit()">
                ‚úèÔ∏è Editar
              </button>
            }
          </div>
        </div>
      </div>
    </div>
  }
</div> @if (vehicleData && isEditing()) {
  <div class="edit-form-container">
    <app-vehicle-form [isEditing]="true" [vehicle]="vehicleData" (edited)="handleEdit($event)"></app-vehicle-form>
  </div>
}

@if (showInquiryForm()) {
  <div class="modal-overlay">
    <div class="form-container">
      <div class="form-header">
        <h3>Formulario de Consulta</h3>
        <button class="close-button" (click)="closeForm()">√ó</button>
      </div>
      <app-inquiry-form [vehicleId]="id!"></app-inquiry-form>
    </div>
  </div>
}

@if (showBookingForm()) {
  <div class="modal-overlay">
    <div class="form-container">
      <div class="form-header">
        <h3>Formulario de Reserva</h3>
        <button class="close-button" (click)="closeForm()">√ó</button>
      </div>
      <app-booking-form [vehicleId]="id!"></app-booking-form>
    </div>
  </div>
}